\pgfplotsset{
  legend entry/.initial=,
  every axis plot post/.code={%
      \pgfkeysgetvalue{/pgfplots/legend entry}\tempValue
      \ifx\tempValue\empty
        \pgfkeysalso{/pgfplots/forget plot}%
      \else
        \expandafter\addlegendentry\expandafter{\tempValue}%
      \fi
    },
}
